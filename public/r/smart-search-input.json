{
  "$schema": "https://shadcn-vue.com/schema/registry-item.json",
  "name": "smart-search-input",
  "type": "registry:component",
  "title": "Smart Search Input",
  "description": "An advanced search input component with filter tree, multi-select, and various input types.",
  "dependencies": [
    "lucide-vue-next"
  ],
  "registryDependencies": [
    "command",
    "button",
    "badge",
    "checkbox",
    "popover",
    "scroll-area",
    "dialog",
    "https://raw.githubusercontent.com/smoosex/inovue-ui/refs/heads/main/public/r/date-time-range-picker.json"
  ],
  "files": [
    {
      "path": "registry/default/smart-search-input/SmartSearchInput.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { Search, X } from \"lucide-vue-next\";\nimport type {\n  FilterOption,\n  FilterValue,\n  FilterInputType,\n  AnyFilterValue,\n  ActiveFilterItem,\n  ActiveFilterRemoveEvent,\n} from \"./types\";\nimport { getI18nText, type Locale } from \"./locales\";\nimport FilterInput from \"./FilterInput.vue\";\nimport FilterSelect from \"./FilterSelect.vue\";\nimport FilterMultiSelect from \"./FilterMultiSelect.vue\";\nimport FilterTreeSelect from \"./FilterTreeSelect.vue\";\nimport FilterCascadeSelect from \"./FilterCascadeSelect.vue\";\nimport { DateTimeRangePicker } from \"@/components/date-time-range-picker\";\n\nconst props = defineProps<{\n  options: FilterOption[];\n  locale?: Locale;\n}>();\n\nconst activeFilters = defineModel<ActiveFilterItem[]>(\"activeFilters\");\n\nconst emit = defineEmits<{\n  (e: \"search\", value: FilterValue): void;\n  (e: \"loadMore\", filterKey: string): void;\n  (e: \"loadChildren\", parentId: string): void;\n  (e: \"removeFilter\", value: ActiveFilterRemoveEvent): void;\n  (e: \"clearAllFilters\"): void;\n}>();\n\nconst locale = computed(() => props.locale || \"en\");\nconst $t = (key: Parameters<typeof getI18nText>[0]) =>\n  getI18nText(key, locale.value);\n\nconst selectedKey = ref(props.options[0]?.value || \"\");\nconst currentOption = computed(() =>\n  props.options.find((o) => o.value === selectedKey.value)\n);\n\nconst resolveComponent = (type?: FilterInputType) => {\n  switch (type) {\n    case \"select\":\n      return FilterSelect;\n    case \"multi-select\":\n      return FilterMultiSelect;\n    case \"tree-multi-select\":\n      return FilterTreeSelect;\n    case \"date-time-range\":\n      return DateTimeRangePicker;\n    case \"cascade-select\":\n      return FilterCascadeSelect;\n    default:\n      return FilterInput;\n  }\n};\n\n// Default value factories using Strategy Pattern\nconst defaultValueFactories: Record<FilterInputType, () => AnyFilterValue> = {\n  text: () => \"\",\n  select: () => \"\",\n  \"multi-select\": () => [],\n  \"tree-multi-select\": () => [],\n  \"date-time-range\": () => ({ from: undefined, to: undefined }),\n  \"cascade-select\": () => ({ level1: undefined, level2: undefined }),\n};\n\nconst getDefaultValue = (type?: FilterInputType): AnyFilterValue => {\n  const factory = defaultValueFactories[type || \"text\"];\n  return factory ? factory() : \"\";\n};\n\n// Initialize with correct type based on first option\nconst currentValue = ref<AnyFilterValue>(\n  getDefaultValue(props.options[0]?.type)\n);\n\n// Reset value and lazy load options when key changes\nwatch(selectedKey, async () => {\n  // Reset value based on type FIRST\n  currentValue.value = getDefaultValue(currentOption.value?.type);\n\n  // Lazy load options if available\n  if (currentOption.value?.loadOptions) {\n    await currentOption.value.loadOptions();\n  }\n});\n\n// Update selectedKey if options change and current key is invalid\nwatch(\n  () => props.options,\n  (newOptions) => {\n    if (\n      newOptions.length > 0 &&\n      !newOptions.find((o) => o.value === selectedKey.value)\n    ) {\n      selectedKey.value = newOptions[0]?.value || \"\";\n    }\n  },\n  { immediate: true }\n);\n\nconst handleSearch = () => {\n  const formatFn = currentOption.value?.formatValue;\n  const formattedValue = formatFn\n    ? formatFn(currentValue.value)\n    : currentValue.value;\n\n  emit(\"search\", {\n    key: selectedKey.value,\n    value: formattedValue,\n  });\n};\n\nconst removeFilter = (key: string, item: ActiveFilterItem) => {\n  activeFilters.value = activeFilters.value?.filter((f) => f.key !== key) || [];\n  emit(\"removeFilter\", { key, item });\n};\n\nconst clearAllFilters = () => {\n  activeFilters.value = [];\n  emit(\"clearAllFilters\");\n};\n</script>\n\n<template>\n  <div class=\"flex flex-col gap-2\">\n    <!-- Search Input -->\n    <div class=\"flex items-center\">\n      <Select v-model=\"selectedKey\">\n      <SelectTrigger class=\"w-50 rounded-r-none border-r-0 focus:ring-0\">\n        <SelectValue :placeholder=\"$t('selectColumn')\" />\n      </SelectTrigger>\n      <SelectContent>\n        <SelectItem\n          v-for=\"option in options\"\n          :key=\"option.value\"\n          :value=\"option.value\"\n        >\n          {{ option.label }}\n        </SelectItem>\n      </SelectContent>\n    </Select>\n\n    <component\n      :is=\"resolveComponent(currentOption?.type)\"\n      :model-value=\"currentValue as any\"\n      @update:model-value=\"(val: any) => (currentValue = val)\"\n      :options=\"currentOption?.options\"\n      :level1-options=\"currentOption?.options\"\n      :placeholder=\"currentOption?.placeholder\"\n      :total=\"currentOption?.total\"\n      :current-page=\"currentOption?.currentPage\"\n      :page-size=\"currentOption?.pageSize\"\n      :level1-label=\"currentOption?.level1Label\"\n      :level2-label=\"currentOption?.level2Label\"\n      :load-children=\"currentOption?.loadChildren\"\n      :locale=\"props.locale\"\n      class=\"rounded-none border\"\n      @search=\"handleSearch\"\n      @load-more=\"currentOption?.loadMore?.()\"\n      @load-children=\"emit('loadChildren', $event)\"\n      :id=\"currentOption?.label\"\n    />\n\n    <Button\n      size=\"icon\"\n      variant=\"outline\"\n      class=\"rounded-l-none border-l-0 bg-transparent\"\n      @click=\"handleSearch\"\n    >\n      <Search class=\"h-4 w-4\" />\n    </Button>\n    </div>\n\n    <!-- Active Filters -->\n    <div v-if=\"activeFilters?.length\" class=\"flex flex-wrap gap-2 items-center\">\n      <div\n        v-for=\"item in activeFilters\"\n        :key=\"item.key\"\n        class=\"flex items-center gap-1 px-2 py-1 text-sm bg-muted rounded-md\"\n      >\n        <span class=\"truncate max-w-40\">{{ item.label }}: {{ item.displayValue }}</span>\n        <button\n          class=\"hover:bg-muted-foreground/20 rounded p-0.5\"\n          @click=\"removeFilter(item.key, item)\"\n        >\n          <X class=\"h-3 w-3\" />\n        </button>\n      </div>\n      <button\n        class=\"text-xs text-muted-foreground hover:text-foreground\"\n        @click=\"clearAllFilters\"\n      >\n        清除全部\n      </button>\n    </div>\n  </div>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/types.ts",
      "content": "import type { DateTimeRange } from \"@/components/date-time-range-picker\";\n\nexport type SelectOption = {\n  label: string;\n  value: string | number;\n  id?: string; // province id\n  children?: SelectOption[];\n  childrenSize?: number;\n};\n\nexport type FilterInputType =\n  | \"text\"\n  | \"select\"\n  | \"multi-select\"\n  | \"tree-multi-select\"\n  | \"date-time-range\"\n  | \"cascade-select\";\n\nexport type CascadeValue = {\n  level1?: string;\n  level2?: string;\n};\n\nexport type FilterInputValueMap = {\n  text: string;\n  select: string | number;\n  \"multi-select\": (string | number)[];\n  \"tree-multi-select\": (string | number)[];\n  \"date-time-range\": DateTimeRange;\n  \"cascade-select\": CascadeValue;\n};\n\nexport type AnyFilterValue = FilterInputValueMap[keyof FilterInputValueMap];\n\nexport type FilterOption = {\n  label: string;\n  value: string;\n  type?: FilterInputType;\n  options?: SelectOption[];\n  placeholder?: string;\n  total?: number;\n  currentPage?: number;\n  pageSize?: number;\n  formatValue?: (value: any) => any;\n  // For advanced filter in advancedSearch\n  formatValueAdvanced?: (value: any) => any;\n  // For cascade-select\n  level1Label?: string;\n  level2Label?: string;\n  // Lazy loading callback - called when field is selected/mounted\n  loadOptions?: () => Promise<void>;\n  // Pagination callback\n  loadMore?: () => Promise<void>;\n  // Cascade select children loader\n  loadChildren?: (parentId: string) => Promise<SelectOption[]>;\n};\n\nexport type FilterValue<T = AnyFilterValue> = {\n  key: string;\n  value: T;\n};\n\nexport type ActiveFilterItem = {\n  key: string;\n  label: string;\n  value: string | number | (string | number)[] | DateTimeRange | CascadeValue;\n  displayValue: string;\n};\n\nexport type ActiveFilterRemoveEvent = {\n  key: string;\n  item: ActiveFilterItem;\n};\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/locales.ts",
      "content": "export type Locale = \"en\" | \"zhHans\";\n\nconst translations = {\n  en: {\n    selectColumn: \"Select column\",\n  },\n  zhHans: {\n    selectColumn: \"选择字段\",\n  },\n} as const;\n\nexport function getI18nText(key: keyof typeof translations.en, locale: Locale) {\n  return translations[locale][key] || translations.en[key];\n}\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/index.ts",
      "content": "export { default as SmartSearchInput } from \"./SmartSearchInput.vue\";\nexport * from \"./types\";\nexport type { Locale } from \"@/components/date-time-range-picker/locales\";\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterInput.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, useAttrs } from \"vue\";\nimport { X } from \"lucide-vue-next\";\nimport { Input } from \"@/components/ui/input\";\nimport { cn } from \"@/lib/utils\";\n\nconst attrs = useAttrs();\n\ndefineOptions({\n  inheritAttrs: false,\n});\n\nconst props = defineProps<{\n  placeholder?: string;\n  id?: string;\n}>();\n\nconst inputId =\n  props.id || `filter-input-${Math.random().toString(36).slice(2)}`;\n\nconst modelValue = defineModel<string>({ required: true });\n\nconst emit = defineEmits<{\n  (e: \"search\"): void;\n}>();\n\nconst handleClear = () => {\n  modelValue.value = \"\";\n  emit(\"search\");\n};\n\nconst inputClass = computed(() =>\n  cn(\n    \"w-50 rounded-none focus-visible:ring-0 focus-visible:ring-offset-0\",\n    attrs.class as string\n  )\n);\n</script>\n\n<template>\n  <div class=\"relative flex items-center flex-1\">\n    <Input\n      :id=\"inputId\"\n      v-model=\"modelValue\"\n      :placeholder=\"placeholder || 'Search'\"\n      :class=\"inputClass\"\n      @keyup.enter=\"emit('search')\"\n    />\n    <button\n      v-if=\"modelValue\"\n      @click=\"handleClear\"\n      class=\"absolute right-2 text-muted-foreground hover:text-foreground\"\n    >\n      <X class=\"h-4 w-4\" />\n    </button>\n  </div>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterSelect.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, useAttrs } from \"vue\";\nimport type { SelectOption } from \"./types\";\nimport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectItem,\n} from \"@/components/ui/select\";\nimport { cn } from \"@/lib/utils\";\n\nconst attrs = useAttrs();\n\ndefineOptions({\n  inheritAttrs: false,\n});\n\ndefineProps<{\n  options?: SelectOption[];\n  placeholder?: string;\n}>();\n\nconst modelValue = defineModel<string | number>();\n\nconst emit = defineEmits<{\n  (e: \"search\"): void;\n}>();\n\n// Auto-trigger search on change\nconst handleChange = (val: any) => {\n  modelValue.value = val || \"\";\n  emit(\"search\");\n};\n\nconst triggerClass = computed(() =>\n  cn(\"w-50 rounded-none border focus:ring-0\", attrs.class as string)\n);\n</script>\n\n<template>\n  <Select\n    :model-value=\"String(modelValue || '')\"\n    @update:model-value=\"handleChange\"\n  >\n    <SelectTrigger :class=\"triggerClass\">\n      <SelectValue\n        :placeholder=\"placeholder || 'Select'\"\n      />\n    </SelectTrigger>\n    <SelectContent>\n      <SelectItem\n        v-for=\"option in options\"\n        :key=\"option.value\"\n        :value=\"String(option.value)\"\n      >\n        {{ option.label }}\n      </SelectItem>\n    </SelectContent>\n  </Select>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterMultiSelect.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref, useAttrs } from \"vue\";\nimport { Check, ChevronsUpDown } from \"lucide-vue-next\";\nimport type { SelectOption } from \"./types\";\nimport { cn } from \"@/lib/utils\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { useVirtualList } from \"@vueuse/core\";\n\nconst attrs = useAttrs();\n\ndefineOptions({\n  inheritAttrs: false,\n});\n\nconst props = withDefaults(\n  defineProps<{\n    options?: SelectOption[];\n    placeholder?: string;\n    id?: string;\n    total?: number;\n    currentPage?: number;\n    pageSize?: number;\n  }>(),\n  {\n    currentPage: 1,\n    pageSize: 20,\n  }\n);\n\nconst modelValue = defineModel<(string | number)[]>(\"modelValue\", {\n  default: () => [],\n});\n\nconst emit = defineEmits<{\n  (e: \"search\"): void;\n  (e: \"loadMore\"): void;\n}>();\n\nconst open = ref(false);\n\nconst VIRTUAL_THRESHOLD = 50;\n\nconst shouldUseVirtual = computed(\n  () => (props.options?.length || 0) > VIRTUAL_THRESHOLD\n);\n\nconst { list, containerProps, wrapperProps } = useVirtualList(\n  computed(() => props.options || []),\n  {\n    itemHeight: 36,\n    overscan: 5,\n  }\n);\n\nconst selectedLabels = computed(() => {\n  if (!modelValue.value || modelValue.value.length === 0) return [];\n  const map = new Map(props.options?.map((o) => [String(o.value), o.label]));\n  return modelValue.value.map((v) => map.get(String(v)) || String(v));\n});\n\nconst toggleSelection = (val: string | number) => {\n  const strVal = String(val);\n  const current = modelValue.value.map(String);\n  const idx = current.indexOf(strVal);\n  let newValue: (string | number)[];\n\n  if (idx > -1) {\n    newValue = [...modelValue.value];\n    newValue.splice(idx, 1);\n  } else {\n    newValue = [...modelValue.value, val];\n  }\n\n  modelValue.value = newValue;\n};\n\nconst handleClear = () => {\n  modelValue.value = [];\n  emit(\"search\");\n};\n\nconst handleLoadMore = () => {\n  emit(\"loadMore\");\n};\n\nconst hasMore = computed(() => {\n  return props.currentPage * props.pageSize < (props.total || 0);\n});\n\nconst triggerClass = computed(() =>\n  cn(\"w-50 justify-between rounded-none\", attrs.class as string)\n);\n</script>\n\n<template>\n  <Popover v-model:open=\"open\">\n    <PopoverTrigger as-child>\n      <Button\n        variant=\"outline\"\n        role=\"combobox\"\n        :aria-expanded=\"open\"\n        :class=\"triggerClass\"\n        :id=\"id\"\n      >\n        <span v-if=\"modelValue.length === 0\" class=\"text-muted-foreground\">\n          {{ placeholder || \"Select\" }}\n        </span>\n        <div\n          v-else-if=\"selectedLabels.length <= 3\"\n          class=\"flex gap-1 overflow-hidden\"\n        >\n          <Badge\n            v-for=\"(label, idx) in selectedLabels\"\n            :key=\"idx\"\n            variant=\"secondary\"\n            class=\"rounded-sm px-1.5 py-0 text-xs font-normal shrink-0\"\n          >\n            {{ label }}\n          </Badge>\n        </div>\n        <Badge\n          v-else\n          variant=\"secondary\"\n          class=\"rounded-sm px-1.5 py-0 text-xs font-normal\"\n        >\n          {{ selectedLabels.length }} selected\n        </Badge>\n        <ChevronsUpDown class=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n      </Button>\n    </PopoverTrigger>\n    <PopoverContent class=\"p-0\" align=\"start\" style=\"width: var(--reka-popper-anchor-width)\">\n      <Command v-if=\"open\">\n        <CommandInput :placeholder=\"placeholder\" :id=\"id\" />\n        <CommandList>\n          <CommandEmpty>No results</CommandEmpty>\n          <CommandGroup>\n            <template v-if=\"options && options.length > 0\">\n              <div v-if=\"shouldUseVirtual\" v-bind=\"containerProps\" class=\"h-64 overflow-auto\">\n                <div v-bind=\"wrapperProps\">\n                  <CommandItem\n                    v-for=\"{ data } in list\"\n                    :key=\"data.value\"\n                    :value=\"data.label\"\n                    @select=\"toggleSelection(data.value)\"\n                    :style=\"{ height: '36px' }\"\n                    class=\"!flex-1 !w-full flex items-center\"\n                  >\n                    <div\n                      class=\"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary shrink-0\"\n                      :class=\"\n                        modelValue.map(String).includes(String(data.value))\n                          ? 'bg-primary text-primary-foreground'\n                          : 'opacity-50 [&_svg]:invisible'\n                      \"\n                    >\n                      <Check class=\"h-4 w-4\" />\n                    </div>\n                    <span>{{ data.label }}</span>\n                  </CommandItem>\n                </div>\n              </div>\n              <template v-else>\n                <CommandItem\n                  v-for=\"option in options\"\n                  :key=\"option.value\"\n                  :value=\"option.label\"\n                  @select=\"toggleSelection(option.value)\"\n                >\n                  <div\n                    class=\"mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary shrink-0\"\n                    :class=\"\n                      modelValue.map(String).includes(String(option.value))\n                        ? 'bg-primary text-primary-foreground'\n                        : 'opacity-50 [&_svg]:invisible'\n                    \"\n                  >\n                    <Check class=\"h-4 w-4\" />\n                  </div>\n                  <span>{{ option.label }}</span>\n                </CommandItem>\n              </template>\n            </template>\n            <CommandItem\n              v-if=\"hasMore\"\n              :value=\"'{load-more}'\"\n              class=\"justify-center text-center text-muted-foreground\"\n              @select=\"handleLoadMore\"\n            >\n              Load more\n            </CommandItem>\n          </CommandGroup>\n          <template v-if=\"modelValue.length > 0\">\n            <CommandSeparator />\n            <CommandGroup>\n              <CommandItem\n                :value=\"'{clear}'\"\n                class=\"justify-center text-center\"\n                @select=\"handleClear\"\n              >\n                Clear filters\n              </CommandItem>\n            </CommandGroup>\n          </template>\n        </CommandList>\n      </Command>\n    </PopoverContent>\n  </Popover>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterTreeSelect.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref, useAttrs } from \"vue\";\nimport { ChevronsUpDown } from \"lucide-vue-next\";\nimport type { SelectOption } from \"./types\";\nimport FilterTreeSelectOption from \"./FilterTreeSelectOption.vue\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandList,\n  CommandSeparator,\n  CommandItem,\n} from \"@/components/ui/command\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { cn } from \"@/lib/utils\";\n\nconst attrs = useAttrs();\n\ndefineOptions({\n  inheritAttrs: false,\n});\n\nconst props = defineProps<{\n  options?: SelectOption[];\n  placeholder?: string;\n  id?: string;\n}>();\n\nconst modelValue = defineModel<(string | number)[]>(\"modelValue\", {\n  default: () => [],\n});\n\nconst emit = defineEmits<{\n  (e: \"search\"): void;\n}>();\n\nconst open = ref(false);\n\nconst itemMap = computed(() => {\n  const map = new Map<string, SelectOption>();\n  const parentMap = new Map<string, SelectOption | null>();\n\n  const traverse = (opts: SelectOption[], parent: SelectOption | null) => {\n    opts.forEach((opt) => {\n      map.set(String(opt.value), opt);\n      parentMap.set(String(opt.value), parent);\n      if (opt.children) {\n        traverse(opt.children, opt);\n      }\n    });\n  };\n  traverse(props.options || [], null);\n  return { map, parentMap };\n});\n\nconst selectedLabels = computed(() => {\n  if (!modelValue.value || modelValue.value.length === 0) return [];\n  return modelValue.value.map(\n    (v) => itemMap.value.map.get(String(v))?.label || String(v),\n  );\n});\n\nconst handleToggle = (val: string | number) => {\n  const strVal = String(val);\n  const currentSet = new Set(modelValue.value.map(String));\n  const isSelecting = !currentSet.has(strVal);\n\n  const { map, parentMap } = itemMap.value;\n  const targetNode = map.get(strVal);\n  if (!targetNode) return;\n\n  const updateDescendants = (node: SelectOption, select: boolean) => {\n    const nodeStrVal = String(node.value);\n    if (select) currentSet.add(nodeStrVal);\n    else currentSet.delete(nodeStrVal);\n\n    if (node.children) {\n      node.children.forEach((child) => void updateDescendants(child, select));\n    }\n  };\n  updateDescendants(targetNode, isSelecting);\n\n  let currentNode = targetNode;\n  while (true) {\n    const parent = parentMap.get(String(currentNode.value));\n    if (!parent) break;\n\n    const parentStrVal = String(parent.value);\n    const siblings = parent.children || [];\n    const allSiblingsSelected = siblings.every((sib) =>\n      currentSet.has(String(sib.value)),\n    );\n\n    if (allSiblingsSelected) {\n      currentSet.add(parentStrVal);\n    } else {\n      currentSet.delete(parentStrVal);\n    }\n\n    currentNode = parent;\n  }\n\n  modelValue.value = Array.from(currentSet);\n};\n\nconst handleClear = () => {\n  modelValue.value = [];\n  emit(\"search\");\n};\n\nconst triggerClass = computed(() =>\n  cn(\"w-50 justify-between rounded-none\", attrs.class as string),\n);\n</script>\n\n<template>\n  <Popover v-model:open=\"open\">\n    <PopoverTrigger as-child>\n      <Button\n        variant=\"outline\"\n        role=\"combobox\"\n        :aria-expanded=\"open\"\n        :class=\"triggerClass\"\n      >\n        <div class=\"flex gap-1 text-left font-normal overflow-hidden flex-1\">\n          <span\n            v-if=\"modelValue.length === 0\"\n            class=\"text-muted-foreground truncate\"\n            >{{ placeholder || \"Select\" }}</span\n          >\n          <template v-else-if=\"modelValue.length <= 3\">\n            <Badge\n              v-for=\"(label, idx) in selectedLabels\"\n              :key=\"idx\"\n              variant=\"secondary\"\n              class=\"rounded-sm px-1.5 py-0 text-xs font-normal shrink-0\"\n            >\n              {{ label }}\n            </Badge>\n          </template>\n          <Badge\n            v-else\n            variant=\"secondary\"\n            class=\"rounded-sm px-1.5 py-0 text-xs font-normal\"\n          >\n            {{ modelValue.length }} selected\n          </Badge>\n        </div>\n        <ChevronsUpDown class=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n      </Button>\n    </PopoverTrigger>\n    <PopoverContent\n      class=\"p-0\"\n      style=\"width: var(--reka-popper-anchor-width)\"\n      align=\"start\"\n    >\n      <Command>\n        <CommandInput :id=\"id\" :placeholder=\"placeholder\" />\n        <CommandList>\n          <CommandEmpty>No results</CommandEmpty>\n          <CommandGroup>\n            <ScrollArea class=\"h-64\">\n              <FilterTreeSelectOption\n                v-for=\"option in options\"\n                :key=\"option.value\"\n                :option=\"option\"\n                :selected-values=\"modelValue\"\n                @toggle=\"handleToggle\"\n              />\n            </ScrollArea>\n          </CommandGroup>\n          <template v-if=\"modelValue.length > 0\">\n            <CommandSeparator />\n            <CommandGroup>\n              <CommandItem\n                :value=\"'{clear}'\"\n                class=\"justify-center text-center\"\n                @select=\"handleClear\"\n              >\n                Clear filters\n              </CommandItem>\n            </CommandGroup>\n          </template>\n        </CommandList>\n      </Command>\n    </PopoverContent>\n  </Popover>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterTreeSelectOption.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref } from \"vue\";\nimport { ChevronRight, ChevronDown } from \"lucide-vue-next\";\nimport type { SelectOption } from \"./types\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\n\nconst props = defineProps<{\n  option: SelectOption;\n  selectedValues: (string | number)[];\n  level?: number;\n}>();\n\nconst emit = defineEmits<{\n  (e: \"toggle\", value: string | number): void;\n}>();\n\nconst isExpanded = ref(false);\nconst currentLevel = props.level || 0;\n\nconst isSelected = computed(() =>\n  props.selectedValues.includes(props.option.value)\n);\n\nconst hasChildren = computed(\n  () => props.option.children && props.option.children.length > 0\n);\n\nconst handleToggleExpand = () => {\n  if (hasChildren.value) {\n    isExpanded.value = !isExpanded.value;\n  }\n};\n\nconst handleCheckboxChange = () => {\n  emit(\"toggle\", props.option.value);\n};\n\nconst handleChildToggle = (val: string | number) => {\n  emit(\"toggle\", val);\n};\n</script>\n\n<template>\n  <div>\n    <div\n      class=\"flex items-center py-1 px-2 hover:bg-accent hover:text-accent-foreground cursor-pointer\"\n      :style=\"{ paddingLeft: `${currentLevel * 16 + 8}px` }\"\n      @click.stop=\"handleToggleExpand\"\n    >\n      <button\n        v-if=\"hasChildren\"\n        class=\"mr-1 h-4 w-4 shrink-0 rounded-sm hover:bg-muted flex items-center justify-center p-0\"\n        @click.stop=\"handleToggleExpand\"\n      >\n        <ChevronDown v-if=\"isExpanded\" class=\"h-3 w-3\" />\n        <ChevronRight v-else class=\"h-3 w-3\" />\n      </button>\n      <span v-else class=\"mr-1 w-4\"></span>\n\n      <Checkbox\n        :id=\"`tree-node-${option.value}`\"\n        :model-value=\"isSelected\"\n        class=\"mr-2\"\n        @update:model-value=\"handleCheckboxChange\"\n      />\n\n      <span class=\"text-sm select-none truncate\">\n        {{ option.label }}\n      </span>\n    </div>\n\n    <div v-if=\"isExpanded && hasChildren\">\n      <FilterTreeSelectOption\n        v-for=\"child in option.children\"\n        :key=\"child.value\"\n        :option=\"child\"\n        :selected-values=\"selectedValues\"\n        :level=\"currentLevel + 1\"\n        @toggle=\"handleChildToggle\"\n      />\n    </div>\n  </div>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/smart-search-input/FilterCascadeSelect.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref, useAttrs } from \"vue\";\nimport { ChevronRight, ChevronsUpDown } from \"lucide-vue-next\";\nimport type { CascadeValue, SelectOption } from \"./types\";\nimport { cn } from \"@/lib/utils\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\nconst attrs = useAttrs();\n\ndefineOptions({\n  inheritAttrs: false,\n});\n\nconst props = defineProps<{\n  level1Options?: SelectOption[];\n  placeholder?: string;\n  id?: string;\n  level1Label?: string;\n  level2Label?: string;\n  loadChildren?: (parentId: string) => Promise<SelectOption[]>;\n}>();\n\nconst modelValue = defineModel<CascadeValue>(\"modelValue\", {\n  default: () => ({}),\n});\n\nconst emit = defineEmits<{\n  (e: \"loadChildren\", parentId: string): void;\n}>();\n\nconst open = ref(false);\nconst activeLevel1 = ref<SelectOption | null>(null);\nconst level2Options = ref<SelectOption[]>([]);\nconst loadingLevel2 = ref(false);\n\n// Display text for trigger\nconst displayText = computed(() => {\n  if (!modelValue.value.level1) return \"\";\n\n  const level1Item = props.level1Options?.find(\n    (o) => String(o.value) === modelValue.value.level1\n  );\n  const level1Label = level1Item?.label || modelValue.value.level1;\n\n  if (!modelValue.value.level2) return level1Label;\n\n  const level2Item = level2Options.value.find(\n    (o) => String(o.value) === modelValue.value.level2\n  );\n  const level2Label = level2Item?.label || modelValue.value.level2;\n\n  return `${level1Label} / ${level2Label}`;\n});\n\nconst handleLevel1Click = async (option: SelectOption) => {\n  // Skip if same option clicked\n  if (activeLevel1.value?.value === option.value) return;\n\n  activeLevel1.value = option;\n  level2Options.value = [];\n\n  // Update model value\n  modelValue.value = {\n    level1: String(option.value),\n    level2: undefined,\n  };\n\n  // Check if has children\n  const hasChildren =\n    (option.children && option.children.length > 0) ||\n    option.childrenSize! > 0;\n\n  if (!hasChildren) {\n    // No children, close popover\n    open.value = false;\n  } else if (option.children && option.children.length > 0) {\n    // Children already loaded\n    level2Options.value = option.children;\n  } else {\n    // Load children\n    const parentId = String(option.id);\n    loadingLevel2.value = true;\n\n    if (props.loadChildren) {\n      // Use helper function\n      try {\n        const options = await props.loadChildren(parentId);\n        level2Options.value = options;\n      } catch (error) {\n        console.error(\"Failed to load children\", error);\n      }\n    } else {\n      // Fallback to emit\n      emit(\"loadChildren\", parentId);\n    }\n\n    loadingLevel2.value = false;\n  }\n};\n\nconst handleLevel2Click = (option: SelectOption) => {\n  modelValue.value = {\n    level1: String(activeLevel1.value?.value),\n    level2: String(option.value),\n  };\n  open.value = false;\n};\n\n// Method to set level2 options externally (deprecated buy kept for backward compatibility if needed)\nconst setLevel2Options = (options: SelectOption[]) => {\n  level2Options.value = options;\n  loadingLevel2.value = false;\n};\n\ndefineExpose({\n  setLevel2Options,\n});\n\nconst triggerClass = computed(() =>\n  cn(\"w-50 justify-between rounded-none\", attrs.class as string)\n);\n</script>\n\n<template>\n  <Popover v-model:open=\"open\">\n    <PopoverTrigger as-child>\n      <Button\n        variant=\"outline\"\n        role=\"combobox\"\n        :aria-expanded=\"open\"\n        :class=\"triggerClass\"\n        :id=\"id\"\n      >\n        <span v-if=\"!displayText\" class=\"text-muted-foreground truncate\">\n          {{ placeholder || \"Select\" }}\n        </span>\n        <Badge\n          v-else\n          variant=\"secondary\"\n          class=\"rounded-sm px-1.5 py-0 text-xs font-normal truncate max-w-full\"\n        >\n          {{ displayText }}\n        </Badge>\n        <ChevronsUpDown class=\"ml-2 h-4 w-4 shrink-0 text-muted-foreground\" />\n      </Button>\n    </PopoverTrigger>\n    <PopoverContent class=\"w-80 p-0\" align=\"start\">\n      <div class=\"flex\">\n        <!-- Level 1 Column -->\n        <div class=\"w-1/2 border-r\">\n          <div\n            class=\"px-2 py-1.5 text-xs font-medium text-muted-foreground border-b\"\n          >\n            {{ level1Label }}\n          </div>\n          <ScrollArea class=\"h-64\">\n            <div\n              v-for=\"option in level1Options\"\n              :key=\"option.value\"\n              class=\"flex items-center justify-between px-2 py-1.5 cursor-pointer hover:bg-muted/50 transition-colors\"\n              :class=\"{\n                'bg-muted': activeLevel1?.value === option.value,\n                'text-primary': modelValue.level1 === String(option.value),\n              }\"\n              @click=\"handleLevel1Click(option)\"\n            >\n              <span class=\"text-sm truncate\">{{ option.label }}</span>\n              <ChevronRight\n                v-if=\"(option as any).childrenSize > 0 || option.children?.length\"\n                class=\"h-4 w-4 shrink-0 opacity-50\"\n              />\n            </div>\n          </ScrollArea>\n        </div>\n\n        <!-- Level 2 Column -->\n        <div class=\"w-1/2\">\n          <div\n            class=\"px-2 py-1.5 text-xs font-medium text-muted-foreground border-b\"\n          >\n            {{ level2Label }}\n          </div>\n          <ScrollArea class=\"h-64\">\n            <div\n              v-if=\"loadingLevel2\"\n              class=\"flex items-center justify-center h-20\"\n            >\n              <span class=\"text-sm text-muted-foreground\">{{\n                \"Loading\"\n              }}</span>\n            </div>\n            <template v-else-if=\"level2Options.length > 0\">\n              <div\n                v-for=\"option in level2Options\"\n                :key=\"option.value\"\n                class=\"px-2 py-1.5 cursor-pointer hover:bg-muted/50 transition-colors\"\n                :class=\"{\n                  'text-primary': modelValue.level2 === String(option.value),\n                }\"\n                @click=\"handleLevel2Click(option)\"\n              >\n                <span class=\"text-sm\">{{ option.label }}</span>\n              </div>\n            </template>\n            <div v-else class=\"flex items-center justify-center p-2\">\n              <span class=\"text-sm text-muted-foreground\">\n                {{\n                  activeLevel1\n                    ? \"No data\"\n                    : \"Select level 1 first\"\n                }}\n              </span>\n            </div>\n          </ScrollArea>\n        </div>\n      </div>\n    </PopoverContent>\n  </Popover>\n</template>\n",
      "type": "registry:component"
    }
  ]
}