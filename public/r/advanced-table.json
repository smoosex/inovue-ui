{
  "$schema": "https://shadcn-vue.com/schema/registry-item.json",
  "name": "advanced-table",
  "type": "registry:component",
  "title": "Advanced Table",
  "description": "A feature-rich data table component with column management, pagination, sticky headers, and auto-tooltip support.",
  "dependencies": [
    "vue-draggable-plus",
    "@vueuse/core"
  ],
  "registryDependencies": [
    "checkbox",
    "table",
    "tooltip",
    "button",
    "sheet",
    "input",
    "select",
    "pagination"
  ],
  "files": [
    {
      "path": "registry/default/advanced-table/AdvancedTable.vue",
      "content": "<script setup lang=\"ts\" generic=\"T extends Record<string, any>\">\nimport { computed, ref, watch, nextTick, onMounted } from \"vue\";\nimport ColumnToggle from \"./components/ColumnToggle.vue\";\nimport TablePagination from \"./components/TablePagination.vue\";\nimport type { Column } from \"./types\";\nimport { useResizeObserver } from \"@vueuse/core\";\nimport {\n  Tooltip,\n  TooltipTrigger,\n  TooltipContent,\n} from \"@/components/ui/tooltip\";\n\ntype Props = {\n  data: T[];\n  total: number;\n  showCheckbox?: boolean;\n  loading?: boolean;\n  rowKey?: string;\n  onReset?: () => void;\n};\n\nconst props = withDefaults(defineProps<Props>(), {\n  showCheckbox: true,\n  loading: false,\n  rowKey: \"id\",\n});\n\nconst selectedIds = defineModel<string[]>(\"selectedIds\", { default: [] });\nconst columns = defineModel<Column[]>(\"columns\", { required: true });\nconst pageNum = defineModel<number>(\"pageNum\", { required: true });\nconst pageSize = defineModel<number>(\"pageSize\", { required: true });\n\nconst visibleColumns = computed(() => columns.value.filter((col) => col.show));\n\nconst allSelected = computed(() => {\n  return (\n    props.data.length > 0 &&\n    props.data.every((item) => selectedIds.value.includes(item[props.rowKey]))\n  );\n});\n\nconst toggleAll = (checked: boolean) => {\n  if (checked) {\n    selectedIds.value = props.data.map((item) => item[props.rowKey]);\n  } else {\n    selectedIds.value = [];\n  }\n};\n\nconst toggleOne = (id: string, checked: boolean) => {\n  const newSelected = [...selectedIds.value];\n  if (checked) {\n    newSelected.push(id);\n  } else {\n    const index = newSelected.indexOf(id);\n    if (index > -1) {\n      newSelected.splice(index, 1);\n    }\n  }\n  selectedIds.value = newSelected;\n};\nconst scrollContainer = ref<HTMLElement | null>(null);\nconst tableRef = ref<HTMLElement | null>(null);\nconst isScrollable = ref(false);\nconst tableWidth = ref(0);\n\nconst checkScrollable = () => {\n  if (!scrollContainer.value) return;\n  isScrollable.value =\n    scrollContainer.value.scrollWidth > scrollContainer.value.clientWidth;\n};\n\nconst updateTableWidth = () => {\n  nextTick(() => {\n    const root = (tableRef.value as any)?.$el;\n    const tableEl = root?.querySelector(\"table\");\n    if (tableEl) {\n      tableWidth.value = tableEl.clientWidth;\n    }\n  });\n};\n\nuseResizeObserver(scrollContainer, checkScrollable);\nuseResizeObserver(tableRef, updateTableWidth);\n\nwatch(\n  [() => props.data, columns, () => props.showCheckbox],\n  () => {\n    nextTick(checkScrollable);\n  },\n  { deep: true },\n);\n\nonMounted(() => {\n  checkScrollable();\n  updateTableWidth();\n});\n\nconst resolveWidth = (width: string | undefined) => {\n  if (!width) return undefined;\n  if (width.endsWith(\"%\")) {\n    const percent = parseFloat(width) / 100;\n    return `${percent * tableWidth.value}px`;\n  }\n  return width;\n};\n\nconst getStickyStyle = (col: Column, isHeader: boolean = false) => {\n  const zIndex = isHeader ? 30 : 20;\n  const hasWidth = col.width !== undefined;\n  const resolvedWidth = resolveWidth(col.width);\n  if (col.fixed === \"right\") {\n    return {\n      position: \"sticky\",\n      right: \"56px\",\n      zIndex,\n      width: resolvedWidth,\n      maxWidth: hasWidth ? resolvedWidth : undefined,\n    } as const;\n  }\n  if (col.fixed === \"left\") {\n    return {\n      position: \"sticky\",\n      left: \"0px\",\n      zIndex,\n      width: resolvedWidth,\n      maxWidth: hasWidth ? resolvedWidth : undefined,\n    } as const;\n  }\n  return {\n    width: resolvedWidth,\n    maxWidth: hasWidth ? resolvedWidth : undefined,\n  } as const;\n};\n\nconst firstRightFixedColumn = computed(() =>\n  visibleColumns.value.find((col) => col.fixed === \"right\"),\n);\n\nconst tooltipDisabled = ref<Record<string, boolean>>({});\n\nconst checkOverflow = (event: MouseEvent, key: string) => {\n  const target = event.currentTarget as HTMLElement;\n  tooltipDisabled.value[key] = target.scrollWidth <= target.clientWidth;\n};\n\nconst getCellClass = (col: Column) => {\n  const ellipsis = col.ellipsis ?? true;\n  return ellipsis ? \"truncate max-w-full\" : \"\";\n};\n</script>\n\n<template>\n  <div class=\"h-full flex flex-col\">\n    <!-- Table Area -->\n    <div\n      class=\"flex-1 overflow-auto relative border rounded-2xl\"\n      ref=\"scrollContainer\"\n    >\n      <Table class=\"table-auto\" ref=\"tableRef\">\n        <TableHeader\n          class=\"sticky top-0 z-30 bg-muted [&_th]:font-bold [&_th:first-child]:pl-4 [&_th:last-child]:pr-4\"\n        >\n          <TableRow>\n            <TableHead v-if=\"showCheckbox\" class=\"w-12.5\">\n              <Checkbox\n                id=\"select-all\"\n                :model-value=\"allSelected\"\n                @update:model-value=\"(v: boolean) => toggleAll(v)\"\n              />\n            </TableHead>\n            <TableHead\n              v-for=\"col in visibleColumns\"\n              :key=\"col.value\"\n              class=\"whitespace-nowrap h-11 px-4 transition-shadow duration-300\"\n              :style=\"getStickyStyle(col, true)\"\n              :class=\"{\n                'bg-muted': col.fixed && isScrollable,\n                'shadow-[4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                  col.fixed === 'left' && isScrollable,\n                'shadow-[-4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                  col.fixed === 'right' &&\n                  col.value === firstRightFixedColumn?.value &&\n                  isScrollable,\n              }\"\n            >\n              {{ col.label }}\n            </TableHead>\n            <TableHead\n              class=\"w-12.5 text-right sticky right-0 z-20 transition-shadow duration-300\"\n              :class=\"{\n                'bg-muted': isScrollable,\n                'shadow-[-4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                  !firstRightFixedColumn && isScrollable,\n              }\"\n            >\n              <ColumnToggle v-model=\"columns\" :on-reset=\"props.onReset\" />\n            </TableHead>\n          </TableRow>\n        </TableHeader>\n        <TableBody class=\"[&_tr>td:first-child]:pl-4 [&_tr>td:last-child]:pr-4\">\n          <template v-if=\"data.length > 0\">\n            <TableRow v-for=\"row in data\" :key=\"row[rowKey]\">\n              <TableCell v-if=\"showCheckbox\">\n                <Checkbox\n                  :id=\"'select-' + row[rowKey]\"\n                  :model-value=\"selectedIds.includes(row[rowKey])\"\n                  @update:model-value=\"\n                    (val: boolean) => toggleOne(row[rowKey], val)\n                  \"\n                />\n              </TableCell>\n              <TableCell\n                v-for=\"col in visibleColumns\"\n                :key=\"col.value\"\n                class=\"whitespace-nowrap py-2 px-4 transition-shadow duration-300\"\n                :style=\"getStickyStyle(col)\"\n                :class=\"[\n                  {\n                    'bg-background': col.fixed && isScrollable,\n                    'shadow-[4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                      col.fixed === 'left' && isScrollable,\n                    'shadow-[-4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                      col.fixed === 'right' &&\n                      col.value === firstRightFixedColumn?.value &&\n                      isScrollable,\n                  },\n                  getCellClass(col),\n                ]\"\n              >\n                <Tooltip\n                  v-if=\"col.enableAutoTooltip !== false\"\n                  :disabled=\"tooltipDisabled[`${row[rowKey]}-${col.value}`]\"\n                >\n                  <TooltipTrigger as-child>\n                    <div\n                      class=\"truncate min-w-0\"\n                      @mouseenter=\"\n                        checkOverflow($event, `${row[rowKey]}-${col.value}`)\n                      \"\n                    >\n                      <slot\n                        name=\"cell\"\n                        :row=\"row\"\n                        :column=\"col\"\n                        :text=\"(row as any)[col.value]\"\n                      >\n                        {{ (row as any)[col.value] }}\n                      </slot>\n                    </div>\n                  </TooltipTrigger>\n                  <TooltipContent>\n                    <slot\n                      name=\"cell\"\n                      :row=\"row\"\n                      :column=\"col\"\n                      :text=\"(row as any)[col.value]\"\n                    >\n                      {{ (row as any)[col.value] }}\n                    </slot>\n                  </TooltipContent>\n                </Tooltip>\n                <slot\n                  v-else\n                  name=\"cell\"\n                  :row=\"row\"\n                  :column=\"col\"\n                  :text=\"(row as any)[col.value]\"\n                >\n                  {{ (row as any)[col.value] }}\n                </slot>\n              </TableCell>\n              <TableCell\n                class=\"sticky right-0 z-20 transition-shadow duration-300\"\n                :class=\"{\n                  'bg-background': isScrollable,\n                  'shadow-[-4px_0_8px_-2px_rgba(0,0,0,0.1)]':\n                    !firstRightFixedColumn && isScrollable,\n                }\"\n              />\n            </TableRow>\n          </template>\n          <template v-else>\n            <TableRow>\n              <TableCell\n                :colspan=\"visibleColumns.length + (showCheckbox ? 2 : 1)\"\n                class=\"h-24 text-center\"\n              >\n                No results.\n              </TableCell>\n            </TableRow>\n          </template>\n        </TableBody>\n      </Table>\n    </div>\n\n    <!-- Pagination Area -->\n    <TablePagination\n      v-model:pageNum=\"pageNum\"\n      v-model:page-size=\"pageSize\"\n      :total=\"total\"\n    />\n  </div>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/advanced-table/types.ts",
      "content": "export type Column = {\n  label: string;\n  value: string;\n  show: boolean;\n  originalIndex?: number;\n  hideInSetting?: boolean;\n  width?: string;\n  fixed?: \"left\" | \"right\";\n  lock?: boolean;\n  enableAutoTooltip?: boolean;\n  ellipsis?: boolean;\n};\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/advanced-table/index.ts",
      "content": "import AdvancedTable from \"./AdvancedTable.vue\";\n\nexport { AdvancedTable };\nexport * from \"./types\";\nexport default AdvancedTable;\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/advanced-table/TablePagination.vue",
      "content": "<script setup lang=\"ts\">\ntype Props = {\n  total: number;\n  pageSizes?: number[];\n};\n\nwithDefaults(defineProps<Props>(), {\n  pageSizes: () => [10, 20, 50, 100],\n});\n\nconst pageNum = defineModel<number>(\"pageNum\", { required: true });\nconst pageSize = defineModel<number>(\"pageSize\", { required: true });\n</script>\n\n<template>\n  <div class=\"pt-4 flex items-center justify-end gap-4 px-2\">\n    <Pagination\n      v-model:page=\"pageNum\"\n      :total=\"total\"\n      :sibling-count=\"1\"\n      show-edges\n      :default-page-size=\"pageSize\"\n      :items-per-page=\"pageSize\"\n    >\n      <PaginationContent v-slot=\"{ items }\">\n        <PaginationFirst />\n        <PaginationPrevious />\n        <template v-for=\"(item, index) in items\">\n          <PaginationItem\n            v-if=\"item.type === 'page'\"\n            :key=\"index\"\n            :value=\"item.value\"\n            :is-active=\"item.value === pageNum\"\n          >\n            {{ item.value }}\n          </PaginationItem>\n          <PaginationEllipsis v-else :key=\"item.type\" :index=\"index\" />\n        </template>\n\n        <!-- Page Size Selector -->\n        <li class=\"flex items-center gap-2 mx-2\">\n          <Select\n            :model-value=\"pageSize.toString()\"\n            @update:model-value=\"(v: string) => (pageSize = Number(v))\"\n          >\n            <SelectTrigger class=\"h-9 w-20\">\n              <SelectValue :placeholder=\"pageSize.toString()\" />\n            </SelectTrigger>\n            <SelectContent side=\"top\">\n              <SelectItem\n                v-for=\"size in pageSizes\"\n                :key=\"size\"\n                :value=\"size.toString()\"\n              >\n                {{ size }}\n              </SelectItem>\n            </SelectContent>\n          </Select>\n          <span class=\"text-sm font-medium whitespace-nowrap\">{{\n            \"/ page\"\n          }}</span>\n          <span class=\"text-sm font-medium whitespace-nowrap ml-2\">\n            Total: <span class=\"text-primary font-bold\">{{ total }}</span>\n          </span>\n        </li>\n\n        <PaginationNext />\n        <PaginationLast />\n      </PaginationContent>\n    </Pagination>\n  </div>\n</template>\n",
      "type": "registry:component"
    },
    {
      "path": "registry/default/advanced-table/ColumnToggle.vue",
      "content": "<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport {\n  Settings2,\n  GripVertical,\n  Plus,\n  X,\n  Search,\n  XCircle,\n} from \"lucide-vue-next\";\nimport { VueDraggable } from \"vue-draggable-plus\";\nimport type { Column } from \"../types\";\n\nconst props = defineProps<{\n  modelValue: Column[];\n  onReset?: () => void;\n}>();\n\nconst emit = defineEmits([\"update:modelValue\"]);\n\nconst isOpen = ref(false);\n\n// Local state for editing\nconst localAvailableColumns = ref<Column[]>([]);\nconst localSelectedColumns = ref<Column[]>([]);\n\n// Search states\nconst availableSearchQuery = ref(\"\");\nconst selectedSearchQuery = ref(\"\");\n\n// Filtered columns\nconst filteredAvailableColumns = computed(() => {\n  if (!availableSearchQuery.value.trim()) return localAvailableColumns.value;\n  const query = availableSearchQuery.value.toLowerCase();\n  return localAvailableColumns.value.filter((col) =>\n    col.label.toLowerCase().includes(query),\n  );\n});\n\nconst filteredSelectedColumns = computed(() => {\n  if (!selectedSearchQuery.value.trim()) return localSelectedColumns.value;\n  const query = selectedSearchQuery.value.toLowerCase();\n  return localSelectedColumns.value.filter((col) =>\n    col.label.toLowerCase().includes(query),\n  );\n});\n\n// Clear search handlers\nconst clearAvailableSearch = () => {\n  availableSearchQuery.value = \"\";\n};\n\nconst clearSelectedSearch = () => {\n  selectedSearchQuery.value = \"\";\n};\n\n// Initialize local state when drawer opens\nwatch(isOpen, (newVal) => {\n  if (newVal) {\n    localAvailableColumns.value = props.modelValue\n      .filter((c) => !c.show && !c.hideInSetting)\n      .sort((a, b) => (a.originalIndex ?? 0) - (b.originalIndex ?? 0));\n    localSelectedColumns.value = props.modelValue.filter(\n      (c) => c.show && !c.hideInSetting,\n    );\n    // Reset search when drawer opens\n    availableSearchQuery.value = \"\";\n    selectedSearchQuery.value = \"\";\n  }\n});\n\nconst addColumn = (col: Column) => {\n  localAvailableColumns.value = localAvailableColumns.value.filter(\n    (c) => c.value !== col.value,\n  );\n  localSelectedColumns.value.push({ ...col, show: true });\n};\n\nconst removeColumn = (col: Column) => {\n  localSelectedColumns.value = localSelectedColumns.value.filter(\n    (c) => c.value !== col.value,\n  );\n  localAvailableColumns.value.push({ ...col, show: false });\n  localAvailableColumns.value.sort(\n    (a, b) => (a.originalIndex ?? 0) - (b.originalIndex ?? 0),\n  );\n};\n\nconst handleConfirm = () => {\n  const hiddenSettingsColumns = props.modelValue.filter((c) => c.hideInSetting);\n\n  const newColumns = [\n    ...localSelectedColumns.value.map((c) => ({ ...c, show: true })),\n    ...localAvailableColumns.value.map((c) => ({ ...c, show: false })),\n    ...hiddenSettingsColumns,\n  ];\n\n  emit(\"update:modelValue\", newColumns);\n  isOpen.value = false;\n};\n\nconst handleReset = () => {\n  props.onReset?.();\n  isOpen.value = false;\n};\n</script>\n\n<template>\n  <Tooltip>\n    <TooltipTrigger as-child>\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        class=\"ml-auto hidden h-8 w-8 lg:flex\"\n        @click=\"isOpen = true\"\n      >\n        <Settings2 class=\"h-4 w-4\" />\n      </Button>\n    </TooltipTrigger>\n    <TooltipContent>\n      <p>Toggle columns</p>\n    </TooltipContent>\n  </Tooltip>\n\n  <Sheet v-model:open=\"isOpen\">\n    <!-- Removed DrawerTrigger, using manual State -->\n    <SheetContent class=\"w-150 sm:max-w-150 flex flex-col gap-0 p-0\">\n      <SheetHeader class=\"p-6 pb-4\">\n        <SheetTitle>Toggle columns</SheetTitle>\n        <SheetDescription>\n          Drag to reorder. Click + to add, X to remove.\n        </SheetDescription>\n      </SheetHeader>\n\n      <div class=\"flex-1 overflow-hidden relative border-t border-b\">\n        <div class=\"h-full flex p-4 gap-4 overflow-hidden\">\n          <!-- Available Columns -->\n          <div\n            class=\"flex-1 border rounded-md p-4 flex flex-col gap-3 min-h-0 overflow-hidden\"\n          >\n            <div class=\"flex flex-col gap-2\">\n              <h3 class=\"font-medium text-sm text-muted-foreground\">\n                Available Columns\n              </h3>\n              <!-- Search Input -->\n              <div class=\"relative group\">\n                <Search\n                  class=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground transition-colors group-focus-within:text-foreground\"\n                />\n                <Input\n                  id=\"available-search-input\"\n                  v-model=\"availableSearchQuery\"\n                  placeholder=\"Search...\"\n                  class=\"pl-9 pr-8\"\n                />\n                <XCircle\n                  v-if=\"availableSearchQuery\"\n                  class=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground cursor-pointer hover:text-foreground transition-colors\"\n                  @click=\"clearAvailableSearch\"\n                />\n              </div>\n            </div>\n            <div class=\"flex-1 overflow-y-auto space-y-2 pr-2\">\n              <div\n                v-for=\"col in filteredAvailableColumns\"\n                :key=\"col.value\"\n                class=\"flex items-center justify-between p-2 rounded-md border bg-card text-card-foreground shadow-sm shrink-0 transition-all hover:border-primary/50 hover:shadow-md\"\n              >\n                <span class=\"text-sm truncate mr-2\" :title=\"col.label\">{{\n                  col.label\n                }}</span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  class=\"h-6 w-6 shrink-0\"\n                  @click=\"addColumn(col)\"\n                >\n                  <Plus class=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <div\n                v-if=\"filteredAvailableColumns.length === 0\"\n                class=\"text-sm text-muted-foreground text-center py-8\"\n              >\n                {{\n                  availableSearchQuery\n                    ? \"No results found\"\n                    : \"No available columns\"\n                }}\n              </div>\n            </div>\n          </div>\n\n          <!-- Selected Columns (Draggable) -->\n          <div\n            class=\"flex-1 border rounded-md p-4 flex flex-col gap-3 min-h-0 overflow-hidden\"\n          >\n            <div class=\"flex flex-col gap-2\">\n              <h3 class=\"font-medium text-sm text-muted-foreground\">\n                Selected Columns\n              </h3>\n              <!-- Search Input -->\n              <div class=\"relative group\">\n                <Search\n                  class=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground transition-colors group-focus-within:text-foreground\"\n                />\n                <Input\n                  id=\"selected-search-input\"\n                  v-model=\"selectedSearchQuery\"\n                  placeholder=\"Search...\"\n                  class=\"pl-9 pr-8\"\n                />\n                <XCircle\n                  v-if=\"selectedSearchQuery\"\n                  class=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground cursor-pointer hover:text-foreground transition-colors\"\n                  @click=\"clearSelectedSearch\"\n                />\n              </div>\n            </div>\n            <div class=\"flex-1 overflow-y-auto pr-2\">\n              <VueDraggable\n                v-model=\"localSelectedColumns\"\n                :animation=\"150\"\n                handle=\".handle\"\n                class=\"space-y-2\"\n              >\n                <div\n                  v-for=\"col in filteredSelectedColumns\"\n                  :key=\"col.value\"\n                  class=\"flex items-center justify-between p-2 rounded-md border bg-card text-card-foreground shadow-sm group shrink-0 transition-all hover:border-primary/50 hover:shadow-md\"\n                >\n                  <div class=\"flex items-center gap-2 overflow-hidden\">\n                    <GripVertical\n                      class=\"handle h-4 w-4 text-muted-foreground cursor-move opacity-50 group-hover:opacity-100 transition-opacity shrink-0\"\n                    />\n                    <span class=\"text-sm truncate\" :title=\"col.label\">{{\n                      col.label\n                    }}</span>\n                  </div>\n                  <Button\n                    v-if=\"!col.lock\"\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    class=\"h-6 w-6 text-muted-foreground hover:text-destructive shrink-0\"\n                    @click=\"removeColumn(col)\"\n                  >\n                    <X class=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </VueDraggable>\n              <div\n                v-if=\"filteredSelectedColumns.length === 0\"\n                class=\"text-sm text-muted-foreground text-center py-8\"\n              >\n                {{\n                  selectedSearchQuery\n                    ? \"No results found\"\n                    : \"No selected columns\"\n                }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <SheetFooter class=\"p-6\">\n        <div class=\"flex items-center justify-between w-full\">\n          <Button variant=\"destructive\" @click=\"handleReset\">\n            Reset\n          </Button>\n          <div class=\"flex gap-2\">\n            <Button variant=\"outline\" @click=\"isOpen = false\">Cancel</Button>\n            <Button @click=\"handleConfirm\">Confirm</Button>\n          </div>\n        </div>\n      </SheetFooter>\n    </SheetContent>\n  </Sheet>\n</template>\n",
      "type": "registry:component"
    }
  ]
}